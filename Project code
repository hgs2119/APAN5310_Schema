DROP TABLE IF EXISTS Investigations;
 DROP TABLE IF EXISTS Publications;
 DROP TABLE IF EXISTS Determinations;
 DROP TABLE IF EXISTS Country;
 DROP TABLE IF EXISTS Products;
 DROP TABLE IF EXISTS Date_Dim;
 DROP TABLE IF EXISTS Commodities;
 DROP TABLE IF EXISTS Case_Groups;
 DROP TABLE IF EXISTS Investigations_Title;
 DROP TABLE IF EXISTS Commissioners;
 DROP TABLE IF EXISTS Staff_Assigned;
 DROP TABLE IF EXISTS Law_Firms;
 DROP TABLE IF EXISTS Petitioning_Firms;


CREATE TABLE Country (
    Country_Code char(3) NOT NULL,
    Country_Name varchar(100),
    Region varchar(100),
    Trade_Relationship varchar(50),
	PRIMARY KEY (Country_Code)
);

CREATE TABLE Products (
    Product_ID char(3) NOT NULL,
    Product_Name varchar(100),
    Product_Type varchar(100),
	PRIMARY KEY (Country_Code)
);

CREATE TABLE Date_Dim (
   [Date] DATE NOT NULL,
   [Day] TINYINT NOT NULL,
   [DaySuffix] CHAR(2) NOT NULL,
   [WeekDayName] VARCHAR(10) NOT NULL,
   [WeekDayName_Short] CHAR(3) NOT NULL,
   [Month] TINYINT NOT NULL,
   [MonthName] VARCHAR(10) NOT NULL,
   [MonthName_Short] CHAR(3) NOT NULL,
   [Quarter] TINYINT NOT NULL,
   [QuarterName] VARCHAR(6) NOT NULL,
   [Year] INT NOT NULL,
   [MMYYYY] CHAR(6) NOT NULL,
   [MonthYear] CHAR(7) NOT NULL,
   PRIMARY KEY (Date)
);

CREATE TABLE Commodities (
    HS_codes char(3) NOT NULL,
    HS_description varchar(500),
	PRIMARY KEY (HS_Codes)
);

CREATE TABLE Case_Groups (
    Group_ID char(5) NOT NULL,
    Group_Name varchar(150) NOT NULL,
    Investigation_Number char(10),
	PRIMARY KEY (Group_ID)
);


CREATE TABLE Commissioners   (
    ID char(10) NOT NULL,
    Commissioner_Name varchar(150),
    Title varchar(150),
	PRIMARY KEY (ID)
);


CREATE TABLE Staff_Assigned  (
    ID char(10) NOT NULL,
    Name varchar(150),
    Title varchar(150),
	PRIMARY KEY (ID)
);

CREATE TABLE Law_Firms   (
    Firm_Name varchar(150) NOT NULL,
    Lead varchar(150) NOT NULL,
	PRIMARY KEY (Firm_Name,Lead)
);


CREATE TABLE Petitioning_Firms  (
    Firm_Name varchar(150) NOT NULL,
    Lead varchar(150) NOT NULL,
	PRIMARY KEY (Firm_Name,Lead)

);

CREATE TABLE Determinations (
    Investigation_Number char(10) NOT NULL,
    Type varchar(100),
    Conference_Hearing_Date DATE,
    Determination varchar(15),
	PRIMARY KEY (Investigation_Number, Type),
	FOREIGN KEY (Conference_Hearing_Date) REFERENCES Date_Dim(Date),
    CHECK (Type IN ('Prelim', 'Final', 'Review'),
	CHECK (Determination IN ('Affirmative', 'Negative', 'Terminated')
);


CREATE TABLE Investigations_Title  (
    Investigation_Number char(10) NOT NULL,
    Investigation_Type varchar(100),
    Investigation_Title char(10) NOT NULL,
	PRIMARY KEY (Number),
	FOREIGN KEY (Investigation_Number) REFERENCES Case_Groups(Investigation_Number),
	FOREIGN KEY (Investigation_Number) REFERENCES Determinations(Investigation_Number),
	FOREIGN KEY (Investigation_Number) REFERENCES Publications(Investigation_Number)
    
);

CREATE TABLE Publications (
    Investigation_Number char(10) NOT NULL,
    Phase varchar(50),
    Pub_No char(4),
	PRIMARY KEY (Investigation_Number),
	FOREIGN KEY (Investigation_Number) REFERENCES Determinations(Investigation_Number),
	FOREIGN KEY (Investigation_Number) REFERENCES Case_Groups(Commissioners)

);

CREATE TABLE Investigations  (
    Investigation_Number char(10) NOT NULL,
    Country_Code char(3) NOT NULL,
    Product_ID char(3) NOT NULL,
	Firm_Name varchar(150),
	PRIMARY KEY (Investigation_Number),
	FOREIGN KEY (Investigation_Number) REFERENCES Case_Groups(Investigation_Number),
	FOREIGN KEY (Investigation_Number) REFERENCES Determinations(Investigation_Number),
	FOREIGN KEY (Investigation_Number) REFERENCES Publications(Investigation_Number),
	FOREIGN KEY (Firm_Name) REFERENCES Law_Firms(Firm_Name),
	FOREIGN KEY (Firm_Name) REFERENCES Petitioning_Firms(Firm_Name)
);
